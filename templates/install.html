{% extends "layout.html" %}

{% block title %}Install Dear Teddy{% endblock %}

{% block styles %}
<style>
    body {
        background-color: #212529 !important;
        color: white !important;
    }
    .install-container {
        position: relative;
        z-index: 1;
    }
    .install-container::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.85);
        z-index: -1;
        border-radius: 15px;
    }
    .lead-heading {
        font-size: 1.5rem;
        background-color: #000000;
        color: #ffffff !important;
        padding: 15px;
        border-radius: 8px;
        display: inline-block;
        margin-bottom: 15px;
        font-weight: bold !important;
        box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        border: 1px solid #444;
    }
    h5 {
        color: white !important;
    }
    
    /* Enhanced button styles */
    .btn-glow {
        position: relative;
        z-index: 1;
        overflow: hidden;
        background-color: #A05C2C; /* Dear Teddy primary color */
        border-color: #A05C2C;
        transition: all 0.3s ease;
    }
    
    .btn-glow:hover {
        background-color: #c77a40;
        border-color: #c77a40;
        transform: translateY(-2px);
        box-shadow: 0 8px 15px rgba(160, 92, 44, 0.4) !important;
    }
    
    .btn-glow::after {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(60deg, 
            rgba(255,255,255,0) 20%, 
            rgba(255,255,255,0.1) 30%, 
            rgba(255,255,255,0.2) 32%, 
            rgba(255,255,255,0.1) 35%, 
            rgba(255,255,255,0) 45%);
        transform: rotate(30deg);
        z-index: -1;
        animation: shine 3s infinite;
    }
    
    @keyframes shine {
        0% { left: -100%; }
        20% { left: 100%; }
        100% { left: 100%; }
    }
    
    /* Pulsing badge animation */
    .pulse-badge {
        animation: pulse-badge 2s infinite;
    }
    
    @keyframes pulse-badge {
        0% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.1);
        }
        100% {
            transform: scale(1);
        }
    }
    
    /* Enhanced browser tab indicators */
    .browser-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        color: #A05C2C;
    }
    
    /* Improved installation step visuals */
    .step-number {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 30px;
        height: 30px;
        background-color: #A05C2C;
        color: white;
        border-radius: 50%;
        margin-right: 10px;
        font-weight: bold;
    }
    
    .installation-step {
        position: relative;
        padding-left: 40px;
        margin-bottom: 15px;
    }
    
    .installation-step::before {
        content: attr(data-step);
        position: absolute;
        left: 0;
        top: 0;
        width: 30px;
        height: 30px;
        background-color: #A05C2C;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
    }
</style>
{% endblock %}

{% block scripts %}
<script>
    // Force dark theme by overriding Bootstrap's data attribute
    document.documentElement.setAttribute('data-bs-theme', 'dark');
</script>
{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8 install-container p-4">
            <div class="text-center mb-5">
                <img src="{{ url_for('static', filename='images/teddy-logo.svg') }}" alt="Dear Teddy Logo" class="mb-4" style="max-width: 100px;" onerror="this.src='{{ url_for('static', filename='images/teddy-logo.png') }}'">
                <h1 class="mb-3 lead-heading">Install Dear Teddy</h1>
                <p class="lead lead-heading">Enhance your mental wellness experience by installing Dear Teddy on your device.</p>
            </div>
            
            <div class="card bg-dark border-primary mb-4">
                <div class="card-body">
                    <h3 class="card-title text-white"><i class="fas fa-star text-primary me-2"></i>Benefits of Installing</h3>
                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="d-flex mb-3">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-wifi-slash fs-3 text-info"></i>
                                </div>
                                <div class="ms-3">
                                    <h5>Works Offline</h5>
                                    <p class="text-light opacity-75">Access your journal entries even without internet connection</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex mb-3">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-bolt fs-3 text-warning"></i>
                                </div>
                                <div class="ms-3">
                                    <h5>Faster Access</h5>
                                    <p class="text-light opacity-75">Launch directly from your home screen with improved speed</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex mb-3">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-bell fs-3 text-danger"></i>
                                </div>
                                <div class="ms-3">
                                    <h5>Push Notifications</h5>
                                    <p class="text-light opacity-75">Receive reminders for journaling and wellness activities</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex mb-3">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-mobile-alt fs-3 text-success"></i>
                                </div>
                                <div class="ms-3">
                                    <h5>App-like Experience</h5>
                                    <p class="text-light opacity-75">Enjoy a full-screen experience without browser controls</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card bg-dark mb-4">
                <div class="card-header">
                    <h3 class="mb-0 text-white"><i class="fas fa-download me-2"></i>Installation Instructions</h3>
                </div>
                <div class="card-body">
                    <div class="mb-4 text-center">
                        <div class="install-button-container position-relative py-4">
                            <div class="position-absolute top-0 start-50 translate-middle-x">
                                <div class="badge bg-danger pulse-badge">Recommended</div>
                            </div>
                            <button id="install-now-btn" class="btn btn-lg btn-primary btn-glow shadow-lg" style="padding: 15px 40px; font-size: 1.25rem;">
                                <i class="fas fa-download me-2"></i>Install Now
                            </button>
                            <div class="position-absolute bottom-0 start-50 translate-middle-x w-100">
                                <p class="text-light opacity-75 mt-3 small">The fastest way to install Dear Teddy on your device</p>
                            </div>
                        </div>
                        <p class="text-warning mt-1"><i class="fas fa-info-circle me-1"></i> If the button doesn't work, follow the manual instructions below</p>
                    </div>
                    
                    <ul class="nav nav-tabs" id="browserTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="chrome-tab" data-bs-toggle="tab" data-bs-target="#chrome" type="button" role="tab">
                                <i class="fab fa-chrome me-1"></i> Chrome
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="safari-tab" data-bs-toggle="tab" data-bs-target="#safari" type="button" role="tab">
                                <i class="fab fa-safari me-1"></i> Safari
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="edge-tab" data-bs-toggle="tab" data-bs-target="#edge" type="button" role="tab">
                                <i class="fab fa-edge me-1"></i> Edge
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="other-tab" data-bs-toggle="tab" data-bs-target="#other" type="button" role="tab">
                                <i class="fas fa-globe me-1"></i> Other
                            </button>
                        </li>
                    </ul>
                    
                    <div class="tab-content p-3 border border-top-0 rounded-bottom" id="browserTabContent">
                        <!-- Chrome Instructions -->
                        <div class="tab-pane fade show active" id="chrome" role="tabpanel">
                            <div class="row text-center mb-4">
                                <div class="col">
                                    <i class="fab fa-chrome browser-icon"></i>
                                    <h4 class="text-white">Google Chrome</h4>
                                </div>
                            </div>
                            
                            <div class="row mb-5">
                                <div class="col-md-6">
                                    <div class="card bg-dark border-primary h-100">
                                        <div class="card-header bg-primary bg-opacity-75 text-white">
                                            <h5 class="mb-0"><i class="fas fa-desktop me-2"></i>On Desktop</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="installation-step" data-step="1">
                                                <p class="mb-2">Look for the install icon <i class="fas fa-arrow-alt-circle-down"></i> in the address bar (right side)</p>
                                                <img src="{{ url_for('static', filename='images/chrome-desktop-step1.png') }}" alt="Chrome Desktop Step 1" class="img-fluid border border-secondary rounded mb-2" onerror="this.style.display='none'">
                                            </div>
                                            
                                            <div class="installation-step" data-step="2">
                                                <p class="mb-2">Click on it and select "Install"</p>
                                                <img src="{{ url_for('static', filename='images/chrome-desktop-step2.png') }}" alt="Chrome Desktop Step 2" class="img-fluid border border-secondary rounded mb-2" onerror="this.style.display='none'">
                                            </div>
                                            
                                            <div class="installation-step" data-step="3">
                                                <p class="mb-2">Alternatively, click the menu button (⋮) and select "Install Dear Teddy..."</p>
                                                <img src="{{ url_for('static', filename='images/chrome-desktop-step3.png') }}" alt="Chrome Desktop Step 3" class="img-fluid border border-secondary rounded mb-2" onerror="this.style.display='none'">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mt-4 mt-md-0">
                                    <div class="card bg-dark border-success h-100">
                                        <div class="card-header bg-success bg-opacity-75 text-white">
                                            <h5 class="mb-0"><i class="fas fa-mobile-alt me-2"></i>On Android</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="installation-step" data-step="1">
                                                <p class="mb-2">Tap the menu button (⋮) in the top right corner</p>
                                                <img src="{{ url_for('static', filename='images/chrome-android-step1.png') }}" alt="Chrome Android Step 1" class="img-fluid border border-secondary rounded mb-2" onerror="this.style.display='none'">
                                            </div>
                                            
                                            <div class="installation-step" data-step="2">
                                                <p class="mb-2">Select "Add to Home screen" or "Install app"</p>
                                                <img src="{{ url_for('static', filename='images/chrome-android-step2.png') }}" alt="Chrome Android Step 2" class="img-fluid border border-secondary rounded mb-2" onerror="this.style.display='none'">
                                            </div>
                                            
                                            <div class="installation-step" data-step="3">
                                                <p class="mb-2">Confirm by tapping "Add" or "Install"</p>
                                                <img src="{{ url_for('static', filename='images/chrome-android-step3.png') }}" alt="Chrome Android Step 3" class="img-fluid border border-secondary rounded mb-2" onerror="this.style.display='none'">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="text-center mt-4">
                                <img src="{{ url_for('static', filename='images/chrome-install.svg') }}" alt="Chrome Install Illustration" class="img-fluid" style="max-width: 300px;" onerror="this.style.display='none'">
                            </div>
                        </div>
                        
                        <!-- Safari Instructions -->
                        <div class="tab-pane fade" id="safari" role="tabpanel">
                            <h4 class="mb-3 text-white">On iOS (iPhone/iPad):</h4>
                            <ol class="list-group list-group-flush">
                                <li class="list-group-item bg-transparent text-white border-secondary">Tap the share button <i class="fas fa-share-square"></i> at the bottom of the screen</li>
                                <li class="list-group-item bg-transparent text-white border-secondary">Scroll down and tap "Add to Home Screen"</li>
                                <li class="list-group-item bg-transparent text-white border-secondary">You can edit the name if desired</li>
                                <li class="list-group-item bg-transparent text-white border-secondary">Tap "Add" in the top right corner</li>
                            </ol>
                            
                            <div class="alert alert-info mt-4">
                                <i class="fas fa-info-circle me-2"></i> Safari on macOS doesn't fully support PWA installation. For desktop use, we recommend Chrome or Edge.
                            </div>
                            
                            <div class="text-center mt-4">
                                <img src="{{ url_for('static', filename='images/safari-install.svg') }}" alt="Safari Install Illustration" class="img-fluid" style="max-width: 300px;">
                            </div>
                        </div>
                        
                        <!-- Edge Instructions -->
                        <div class="tab-pane fade" id="edge" role="tabpanel">
                            <h4 class="mb-3 text-white">On Desktop:</h4>
                            <ol class="list-group list-group-flush">
                                <li class="list-group-item bg-transparent text-white border-secondary">Look for the install icon <i class="fas fa-plus-square"></i> in the address bar</li>
                                <li class="list-group-item bg-transparent text-white border-secondary">Click it and select "Install"</li>
                                <li class="list-group-item bg-transparent text-white border-secondary">Alternatively, click the menu button (...) and select "Apps" > "Install this site as an app"</li>
                            </ol>
                            
                            <div class="text-center mt-4">
                                <img src="{{ url_for('static', filename='images/edge-install.svg') }}" alt="Edge Install Illustration" class="img-fluid" style="max-width: 300px;">
                            </div>
                        </div>
                        
                        <!-- Other Browsers Instructions -->
                        <div class="tab-pane fade" id="other" role="tabpanel">
                            <h4 class="mb-3 text-white">General Instructions:</h4>
                            <ol class="list-group list-group-flush">
                                <li class="list-group-item bg-transparent text-white border-secondary">Look for "Add to Home Screen" or "Install" in your browser's menu</li>
                                <li class="list-group-item bg-transparent text-white border-secondary">On mobile, this is often found in the share menu</li>
                                <li class="list-group-item bg-transparent text-white border-secondary">On desktop, look for an install icon in the address bar or browser menu</li>
                            </ol>
                            
                            <div class="alert alert-warning mt-4">
                                <i class="fas fa-exclamation-triangle me-2"></i> Some browsers have limited PWA support. For the best experience, we recommend using Chrome, Edge, or Safari on iOS.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card bg-dark border-info mb-4">
                <div class="card-body">
                    <h4 class="card-title text-white"><i class="fas fa-question-circle text-info me-2"></i>Frequently Asked Questions</h4>
                    
                    <div class="accordion mt-3" id="faqAccordion">
                        <div class="accordion-item bg-dark">
                            <h2 class="accordion-header" id="headingOne">
                                <button class="accordion-button collapsed bg-dark text-white" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                                    Do I need to download anything from an app store?
                                </button>
                            </h2>
                            <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    No, you don't need to go through any app store. Progressive Web Apps install directly from your browser to your device, saving you time and storage space.
                                </div>
                            </div>
                        </div>
                        
                        <div class="accordion-item bg-dark">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button collapsed bg-dark text-white" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                    Will the app work when I'm offline?
                                </button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Yes! Once installed, Dear Teddy will work offline for many features. You'll be able to access previously viewed pages and some core functionality even without an internet connection.
                                </div>
                            </div>
                        </div>
                        
                        <div class="accordion-item bg-dark">
                            <h2 class="accordion-header" id="headingThree">
                                <button class="accordion-button collapsed bg-dark text-white" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                    How do I uninstall the app?
                                </button>
                            </h2>
                            <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    <p>To uninstall Dear Teddy:</p>
                                    <ul>
                                        <li><strong>On Android:</strong> Same as any other app - long press the icon and select "Uninstall"</li>
                                        <li><strong>On iOS:</strong> Long press the app icon, tap "Remove App", then confirm</li>
                                        <li><strong>On Desktop:</strong> Look for app settings/management in your browser, or right-click the app icon and select remove/uninstall</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="accordion-item bg-dark">
                            <h2 class="accordion-header" id="headingFour">
                                <button class="accordion-button collapsed bg-dark text-white" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                    Will the app automatically update?
                                </button>
                            </h2>
                            <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Yes, the app will automatically check for updates when you're online. When a new version is available, you'll be notified and can update with a single click.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Handle install button clicks
    document.addEventListener('DOMContentLoaded', () => {
        const installButton = document.getElementById('install-now-btn');
        if (installButton) {
            installButton.addEventListener('click', () => {
                if (typeof window.triggerInstall === 'function') {
                    window.triggerInstall();
                } else {
                    // Fallback if the function isn't available
                    alert('Installation not available. Please follow the manual instructions for your browser.');
                }
            });
        }
        
        // Detect browser and select appropriate tab
        const userAgent = navigator.userAgent;
        if (userAgent.indexOf("Safari") > -1 && userAgent.indexOf("Chrome") == -1) {
            document.getElementById('safari-tab').click();
        } else if (userAgent.indexOf("Edge") > -1) {
            document.getElementById('edge-tab').click();
        } else if (userAgent.indexOf("Chrome") == -1 && userAgent.indexOf("Safari") == -1 && userAgent.indexOf("Edge") == -1) {
            document.getElementById('other-tab').click();
        }
        
        // Hide install button if already installed
        if (window.matchMedia('(display-mode: standalone)').matches ||
            window.navigator.standalone === true) {
            installButton.style.display = 'none';
            
            // Show already installed message
            const container = installButton.parentElement;
            const message = document.createElement('div');
            message.className = 'alert alert-success';
            message.innerHTML = '<i class="fas fa-check-circle me-2"></i>Dear Teddy is already installed on your device!';
            container.replaceChild(message, installButton);
        }
    });
</script>
{% endblock %}